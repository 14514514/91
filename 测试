local Players = game:GetService("Players")
local player = Players.LocalPlayer
local mouse = player:GetMouse()
local UserInputService = game:GetService("UserInputService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "SkullGloveUI"
screenGui.Parent = player.PlayerGui

local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 300, 0, 40)
mainFrame.Position = UDim2.new(0.5, -150, 0.3, -50)
mainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
mainFrame.BorderSizePixel = 0
mainFrame.Parent = screenGui

local title = Instance.new("TextButton")
title.Text = "ğŸ’€ éª·é«…æ‰‹å¥—æ§åˆ¶é¢æ¿ ğŸ’€"
title.Size = UDim2.new(1, 0, 0, 40)
title.Position = UDim2.new(0, 0, 0, 0)
title.BackgroundColor3 = Color3.fromRGB(50, 50, 70)
title.TextColor3 = Color3.new(1, 1, 1)
title.Font = Enum.Font.GothamBold
title.TextSize = 18
title.AutoButtonColor = false
title.Parent = mainFrame

local contentFrame = Instance.new("Frame")
contentFrame.Size = UDim2.new(1, 0, 0, 350)
contentFrame.Position = UDim2.new(0, 0, 1, 0)
contentFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
contentFrame.BorderSizePixel = 0
contentFrame.Visible = false
contentFrame.Parent = mainFrame

local loopAllBtn = Instance.new("TextButton")
loopAllBtn.Name = "LoopAllBtn"
loopAllBtn.Text = "å¼€å¯å¾ªç¯æ‹é£æ‰€æœ‰äºº"
loopAllBtn.Size = UDim2.new(0.8, 0, 0, 40)
loopAllBtn.Position = UDim2.new(0.1, 0, 0.05, 0)
loopAllBtn.BackgroundColor3 = Color3.fromRGB(70, 120, 70)
loopAllBtn.TextColor3 = Color3.new(1, 1, 1)
loopAllBtn.Font = Enum.Font.Gotham
loopAllBtn.TextSize = 16
loopAllBtn.Parent = contentFrame

local playerInput = Instance.new("TextBox")
playerInput.PlaceholderText = "è¾“å…¥ç©å®¶åå­— (å¤šä¸ªç”¨ç©ºæ ¼/é€—å·/åˆ†å·éš”å¼€)"
playerInput.Size = UDim2.new(0.8, 0, 0, 30)
playerInput.Position = UDim2.new(0.1, 0, 0.2, 0)
playerInput.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
playerInput.TextColor3 = Color3.new(1, 1, 1)
playerInput.Font = Enum.Font.Gotham
playerInput.TextSize = 14
playerInput.Parent = contentFrame

local flySpecificBtn = Instance.new("TextButton")
flySpecificBtn.Name = "FlySpecificBtn"
flySpecificBtn.Text = "æ‹é£æŒ‡å®šç©å®¶"
flySpecificBtn.Size = UDim2.new(0.8, 0, 0, 40)
flySpecificBtn.Position = UDim2.new(0.1, 0, 0.3, 0)
flySpecificBtn.BackgroundColor3 = Color3.fromRGB(70, 70, 120)
flySpecificBtn.TextColor3 = Color3.new(1, 1, 1)
flySpecificBtn.Font = Enum.Font.Gotham
flySpecificBtn.TextSize = 16
flySpecificBtn.Parent = contentFrame

local loopSpecificBtn = Instance.new("TextButton")
loopSpecificBtn.Name = "LoopSpecificBtn"
loopSpecificBtn.Text = "å¼€å¯å¾ªç¯æ‹é£æŒ‡å®šç©å®¶"
loopSpecificBtn.Size = UDim2.new(0.8, 0, 0, 40)
loopSpecificBtn.Position = UDim2.new(0.1, 0, 0.45, 0)
loopSpecificBtn.BackgroundColor3 = Color3.fromRGB(120, 70, 70)
loopSpecificBtn.TextColor3 = Color3.new(1, 1, 1)
loopSpecificBtn.Font = Enum.Font.Gotham
loopSpecificBtn.TextSize = 16
loopSpecificBtn.Parent = contentFrame

local closeAllBtn = Instance.new("TextButton")
closeAllBtn.Name = "CloseAllBtn"
closeAllBtn.Text = "å…³é—­æ‰€æœ‰å¾ªç¯"
closeAllBtn.Size = UDim2.new(0.8, 0, 0, 40)
closeAllBtn.Position = UDim2.new(0.1, 0, 0.6, 0)
closeAllBtn.BackgroundColor3 = Color3.fromRGB(100, 40, 40)
closeAllBtn.TextColor3 = Color3.new(1, 1, 1)
closeAllBtn.Font = Enum.Font.Gotham
closeAllBtn.TextSize = 16
closeAllBtn.Parent = contentFrame

local goldBtn = Instance.new("TextButton")
goldBtn.Name = "GoldBtn"
goldBtn.Text = "é‡‘å¸+100"
goldBtn.Size = UDim2.new(0.8, 0, 0, 40)
goldBtn.Position = UDim2.new(0.1, 0, 0.75, 0)
goldBtn.BackgroundColor3 = Color3.fromRGB(180, 150, 30)
goldBtn.TextColor3 = Color3.new(1, 1, 1)
goldBtn.Font = Enum.Font.Gotham
goldBtn.TextSize = 16
goldBtn.Parent = contentFrame

local authorLabel = Instance.new("TextLabel")
authorLabel.Text = "ä½œè€… QQ: 195118463"
authorLabel.Size = UDim2.new(1, 0, 0, 20)
authorLabel.Position = UDim2.new(0, 0, 0.95, 0)
authorLabel.BackgroundTransparency = 1
authorLabel.TextColor3 = Color3.fromRGB(180, 180, 180)
authorLabel.Font = Enum.Font.Gotham
authorLabel.TextSize = 12
authorLabel.Parent = contentFrame

local toggleBtn = Instance.new("TextButton")
toggleBtn.Text = "â–¼"
toggleBtn.Size = UDim2.new(0, 30, 0, 30)
toggleBtn.Position = UDim2.new(1, -35, 0.5, -15)
toggleBtn.BackgroundTransparency = 1
toggleBtn.TextColor3 = Color3.new(1, 1, 1)
toggleBtn.Font = Enum.Font.GothamBold
toggleBtn.TextSize = 20
toggleBtn.Parent = title

local dragging = false
local dragInput, dragStart, startPos

local function updateInput(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input.Position
    end
end

title.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = mainFrame.Position
        
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement and dragging then
        local delta = input.Position - dragStart
        mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

local function flyPlayer(targetPlayer)
    local character = player.Character
    if not character then return end
    
    local backpack = player:FindFirstChild("Backpack")
    if not backpack then return end
    
    local skullGlove = backpack:FindFirstChild("Skull_Glove")
    if not skullGlove then return end
    
    local event = skullGlove:FindFirstChild("Event")
    if not event then return end
    
    local targetChar = targetPlayer.Character
    if not targetChar then return end
    
    local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
    local targetRoot = targetChar:FindFirstChild("HumanoidRootPart")
    
    if humanoidRootPart and targetRoot then
        local direction = (targetRoot.Position - humanoidRootPart.Position).Unit * 15
        local args = {
            "slash",
            targetChar,
            Vector3.new(direction.X, 0.5, direction.Z)
        }
        event:FireServer(unpack(args))
    end
end

local function parsePlayerNames(input)
    local names = {}
    local cleaned = input:gsub("[,;]+", " ")
    for name in cleaned:gmatch("%S+") do
        table.insert(names, name)
    end
    return names
end

local function findPlayers(names)
    local players = {}
    for _, name in ipairs(names) do
        for _, p in ipairs(Players:GetPlayers()) do
            if p ~= player and p.Name:lower():find(name:lower(), 1, true) then
                table.insert(players, p)
            end
        end
    end
    return players
end

local function addGold()
    local event = ReplicatedStorage:WaitForChild("RestartRemotes"):WaitForChild("GiveClaimMoney")
    local args = {
        player
    }
    event:FireServer(unpack(args))
end

local loopAllActive = false
local loopSpecificActive = false
local loopSpecificPlayers = {}

title.MouseButton1Click:Connect(function()
    contentFrame.Visible = not contentFrame.Visible
    if contentFrame.Visible then
        toggleBtn.Text = "â–¼"
        mainFrame.Size = UDim2.new(0, 300, 0, 390)
    else
        toggleBtn.Text = "â–²"
        mainFrame.Size = UDim2.new(0, 300, 0, 40)
    end
end)

loopAllBtn.MouseButton1Click:Connect(function()
    loopAllActive = not loopAllActive
    if loopAllActive then
        loopAllBtn.Text = "åœæ­¢å¾ªç¯æ‹é£æ‰€æœ‰äºº"
        loopAllBtn.BackgroundColor3 = Color3.fromRGB(120, 70, 70)
        
        spawn(function()
            while loopAllActive and task.wait(0.8) do
                for _, targetPlayer in ipairs(Players:GetPlayers()) do
                    if targetPlayer ~= player then
                        flyPlayer(targetPlayer)
                    end
                end
            end
            loopAllBtn.Text = "å¼€å¯å¾ªç¯æ‹é£æ‰€æœ‰äºº"
            loopAllBtn.BackgroundColor3 = Color3.fromRGB(70, 120, 70)
        end)
    else
        loopAllBtn.Text = "å¼€å¯å¾ªç¯æ‹é£æ‰€æœ‰äºº"
        loopAllBtn.BackgroundColor3 = Color3.fromRGB(70, 120, 70)
    end
end)

flySpecificBtn.MouseButton1Click:Connect(function()
    local input = playerInput.Text
    if input == "" then return end
    
    local names = parsePlayerNames(input)
    local players = findPlayers(names)
    
    for _, targetPlayer in ipairs(players) do
        flyPlayer(targetPlayer)
    end
end)

loopSpecificBtn.MouseButton1Click:Connect(function()
    loopSpecificActive = not loopSpecificActive
    if loopSpecificActive then
        local input = playerInput.Text
        if input == "" then return end
        
        loopSpecificBtn.Text = "åœæ­¢å¾ªç¯æ‹é£æŒ‡å®šç©å®¶"
        loopSpecificBtn.BackgroundColor3 = Color3.fromRGB(120, 70, 70)
        
        local names = parsePlayerNames(input)
        loopSpecificPlayers = findPlayers(names)
        
        spawn(function()
            while loopSpecificActive and task.wait(0.8) do
                for _, targetPlayer in ipairs(loopSpecificPlayers) do
                    flyPlayer(targetPlayer)
                end
            end
            loopSpecificBtn.Text = "å¼€å¯å¾ªç¯æ‹é£æŒ‡å®šç©å®¶"
            loopSpecificBtn.BackgroundColor3 = Color3.fromRGB(120, 70, 70)
        end)
    else
        loopSpecificBtn.Text = "å¼€å¯å¾ªç¯æ‹é£æŒ‡å®šç©å®¶"
        loopSpecificBtn.BackgroundColor3 = Color3.fromRGB(120, 70, 70)
    end
end)

closeAllBtn.MouseButton1Click:Connect(function()
    loopAllActive = false
    loopSpecificActive = false
    
    loopAllBtn.Text = "å¼€å¯å¾ªç¯æ‹é£æ‰€æœ‰äºº"
    loopAllBtn.BackgroundColor3 = Color3.fromRGB(70, 120, 70)
    
    loopSpecificBtn.Text = "å¼€å¯å¾ªç¯æ‹é£æŒ‡å®šç©å®¶"
    loopSpecificBtn.BackgroundColor3 = Color3.fromRGB(120, 70, 70)
end)

goldBtn.MouseButton1Click:Connect(function()
    addGold()
end)
